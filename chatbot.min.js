document.addEventListener('DOMContentLoaded',async()=>{const e=document.getElementById('chat-widget'),t=document.getElementById('minimize-chat'),s=document.getElementById('chat-input'),a=document.getElementById('send-message'),o=document.getElementById('chat-messages');let n=!0;e.style.height='50px',t.innerHTML='<i class="fas fa-plus"></i>',t.addEventListener('click',()=>{n=!n,e.style.height=n?'50px':'500px',t.innerHTML=n?'<i class="fas fa-plus"></i>':'<i class="fas fa-minus"></i>',!n&&0===o.children.length&&setTimeout(()=>{i(`ðŸŽ¯ **EXCLUSIVE OFFER: FREE Google Ads + Website Audit!** ðŸŽ¯\n\nHi! I'm Marlon's AI assistant, and I'm excited to offer you something special today.\n\n**Get a comprehensive audit worth $200 absolutely FREE!** I'll analyze:\nâœ… Your Google Ads account structure & performance\nâœ… Keyword targeting effectiveness  \nâœ… Landing page optimization opportunities\nâœ… Competitor analysis insights\nâœ… Actionable recommendations to boost ROI\n\n**No strings attached** - just pure value to help your business grow.\n\nReady to unlock your campaign's potential? Just ask me anything about Google Ads, digital marketing, or let's schedule your free audit! What's on your mind?`, 'bot')},500)}),s.addEventListener('keypress',e=>{'Enter'===e.key&&!e.shiftKey&&(e.preventDefault(),l())}),a.addEventListener('click',l),d();let r='';async function d(){try{const e=await fetch('faq.file');if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);r=await e.text()}catch(e){console.error('Error loading FAQ knowledge base:',e),r='# Marlon Palomares Portfolio - FAQ Knowledge Base\n\n## Personal Information\n**Name:** Marlon Palomares  \n**Title:** Google Ads Specialist  \n**Email:** Mpalomaresdigital@gmail.com  \n**Website:** https://mpalomaresdigitalsolutions.github.io/MPDIGITAL/\n\n## Professional Summary\nA results-driven Google Ads specialist with hands-on campaign management experience, trained by Ian Baillo, the Philippines\' top Google Ads expert. Currently managing a $10,000 monthly search campaign for a nonprofit through VolunteerMatch. Over 4 years of experience with US-based clients.\n\n## Service Packages\n- Launchpad: $150/month (small businesses, $200-500 ad budget)\n- Growth: $300/month (growing businesses, $500-1,500 ad budget)  \n- Total Control: $500+/month (established businesses, $1,500+ ad budget)\n\n## Key Achievements\n- Managing $10,000/month Google Ads campaign for nonprofit\n- Trained by Ian Baillo (Philippines\' top Google Ads expert)\n- Google Ads certified with advanced optimization training\n- 4+ years experience with US-based clients'}console.log('FAQ knowledge base loaded successfully.')}function c(e,t){const s=document.createElement('div');s.classList.add('chat-message',`${t}-message`),s.innerHTML=e.replace(/\n/g,'<br>').replace(/\*\*(.*?)\*\*/g,'<strong>$1</strong>').replace(/\*(.*?)\*/g,'<em>$1</em>'),o.appendChild(s),o.scrollTop=o.scrollHeight}function i(e,t){const s=document.createElement('div');s.classList.add('chat-message',`${t}-message`),o.appendChild(s);let a=0;const n=20;!function t(){if(a<e.length){const o=e[a];'\n'===o?s.innerHTML+='<br>':'*'===o&&'*'===e[a+1]?(s.innerHTML+=`<strong>${e.substring(a+2,e.indexOf('**',a+2))}</strong>`,a=e.indexOf('**',a+2)+1):'*'===o&&'*'!==e[a+1]?(s.innerHTML+=`<em>${e.substring(a+1,e.indexOf('*',a+1))}</em>`,a=e.indexOf('*',a+1)):s.innerHTML+=o,a++,o.scrollTop=o.scrollHeight,setTimeout(t,n)}}()}function p(){const e=document.createElement('div');e.innerHTML='\n            <div id="image-lightbox" class="image-lightbox" style="display: none;">\n                <div class="lightbox-content">\n                    <span class="lightbox-close">&times;</span>\n                    <img class="lightbox-image" src="" alt="">\n                    <div class="lightbox-caption"></div>\n                </div>\n            </div>\n        ',document.body.appendChild(e.firstElementChild);const t=document.getElementById('image-lightbox'),s=document.querySelectorAll('.ghl-image-preview'),a=document.querySelector('.lightbox-close'),o=document.querySelector('.lightbox-image'),n=document.querySelector('.lightbox-caption');s.forEach(e=>{e.addEventListener('click',e=>{const s=e.target.dataset.fullsize||e.target.src,a=e.target.dataset.caption||e.target.alt;o.src=s,n.textContent=a,t.style.display='flex'})}),a.addEventListener('click',()=>t.style.display='none'),t.addEventListener('click',e=>{e.target===t&&(t.style.display='none')})}async function l(){const e=s.value.trim();if(!e)return;c(e,'user'),s.value='',s.disabled=!0,a.disabled=!0;try{const t=await fetch('https://mpalomaresdigitalsolutions.netlify.app/.netlify/functions/deepseek',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({message:e,context:r})});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const{response:s}=await t.json();i(s,'bot')}catch(e){console.error('Error:',e),i('I apologize, but I\'m having trouble connecting to the AI service. Please try again later, or contact Marlon directly at Mpalomaresdigital@gmail.com','bot')}finally{s.disabled=!1,a.disabled=!1,s.focus()}}p()})